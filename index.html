<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Philosopher â€” Le Bon Concept</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#38bdf8;--muted:#94a3b8}
    html,body{height:100%;margin:0;font-family:Georgia,serif;background:linear-gradient(180deg,#0a0f1d 0%,#10192c 100%);color:#e6eef8}
    .wrap{max-width:1000px;margin:24px auto;padding:18px}
    header{display:flex;align-items:center;gap:12px}
    h1{margin:0;font-size:20px}
    .board{display:grid;grid-template-columns:260px 1fr 260px;gap:14px;margin-top:18px}
    .panel{background:linear-gradient(180deg,var(--card),#0d1528);border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(2,6,23,.6)}

    .bottles{display:grid;gap:10px}
    .bottle{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;background:rgba(255,255,255,0.03);cursor:pointer;transition:transform .12s}
    .bottle:hover{transform:translateY(-4px)}
    .bottle .cap{width:40px;height:40px;border-radius:6px;background:#0f1724;display:flex;align-items:center;justify-content:center;font-weight:700}
    .bottle .meta{flex:1}
    .bottle .meta small{display:block;color:var(--muted)}

    .bar-view{display:flex;flex-direction:column;align-items:center;gap:12px;padding:18px}
    .stage{width:100%;max-width:520px;height:260px;border-radius:14px;background:linear-gradient(180deg,#081223,#0c1b2a);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
    .glass{width:160px;height:180px;border:2px solid rgba(255,255,255,0.08);border-radius:12px;background:rgba(255,255,255,0.02);overflow:hidden;display:flex;flex-direction:column-reverse;align-items:center}
    .liquid{width:100%;transition:height .35s ease, background .25s linear;display:block}
    .garnish{position:absolute;top:12px;right:12px;font-size:22px}
    .controls{display:flex;gap:10px;align-items:center;margin-top:8px}
    button{background:transparent;border:1px solid rgba(255,255,255,0.06);color:inherit;padding:8px 10px;border-radius:8px;cursor:pointer}
    .btn-primary{background:var(--accent);color:#071021;border:none}

    .recipes{display:flex;flex-direction:column;gap:10px}
    .recipe{padding:10px;border-radius:8px;background:rgba(255,255,255,0.02)}
    .history{max-height:240px;overflow:auto;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)}

    .reaction{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-size:24px;padding:10px 18px;border-radius:12px;background:rgba(0,0,0,0.6);opacity:0;transition:opacity .25s,transform .35s}
    .reaction.show{opacity:1;transform:translate(-50%,-90%)}

    footer{margin-top:14px;color:var(--muted);font-size:13px}
    @media (max-width:900px){.board{grid-template-columns:1fr;}.panel{padding:10px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Philosopher â€” Le Bon Concept</h1>
      <div style="margin-left:auto;color:var(--muted)">Ajoutez des notions â€¢ Secouez â€¢ Formulez</div>
    </header>

    <div class="board">
      <div class="panel">
        <h3>Notions</h3>
        <div class="bottles" id="bottles"></div>
      </div>

      <div class="panel bar-view">
        <div class="stage">
          <div class="glass" id="glass">
            <div id="liquid" class="liquid" style="height:0%"></div>
          </div>
          <div class="garnish" id="garnish">ðŸ“œ</div>
          <div class="reaction" id="reaction">OK</div>
        </div>

        <div class="controls">
          <button id="undo">Annuler</button>
          <button id="clear">Vider</button>
          <button id="shake">Dialectiser</button>
          <button class="btn-primary" id="serve">Publier</button>
        </div>

        <div style="width:100%;display:flex;justify-content:space-between;margin-top:8px">
          <div>Concept: <span id="volume">0</span>/100</div>
          <div>Ã‰tat: <span id="state">Calme</span></div>
        </div>
      </div>

      <div class="panel">
        <h3>Doctrines suggÃ©rÃ©es</h3>
        <div class="recipes" id="recipes"></div>
        <h3 style="margin-top:12px">Historique</h3>
        <div class="history" id="history"></div>
      </div>
    </div>

    <footer>Fichier autonome â€” <code>philosopher.html</code></footer>
  </div>

  <script>
    const INGREDIENTS = [
      {id:'raison',name:'Raison',abbr:'R',strength:40,flavor:0.1,color:'#b0d4ff'},
      {id:'sens',name:'SensibilitÃ©',abbr:'S',strength:0,flavor:0.5,color:'#ffd580'},
      {id:'foi',name:'Foi',abbr:'F',strength:0,flavor:0.6,color:'#e2baf5'},
      {id:'liberte',name:'LibertÃ©',abbr:'L',strength:20,flavor:0.3,color:'#9fffa6'},
      {id:'nature',name:'Nature',abbr:'N',strength:0,flavor:0.4,color:'#afffaf'},
      {id:'travail',name:'Travail',abbr:'T',strength:10,flavor:0.2,color:'#f2c88f'},
      {id:'langage',name:'Langage',abbr:'La',strength:0,flavor:0.35,color:'#d4d4ff'},
      {id:'pouvoir',name:'Pouvoir',abbr:'P',strength:35,flavor:0.15,color:'#ff9e9e'},
      {id:'temps',name:'Temps',abbr:'Te',strength:0,flavor:0.25,color:'#cccccc'},
      {id:'inconscient',name:'Inconscient',abbr:'I',strength:15,flavor:0.5,color:'#cba6f7'}
    ];

    const RECIPES = [
      {name:'Rationalisme cartÃ©sien',mix:{raison:60,liberte:20,nature:20},desc:'ClartÃ© et distinction'},
      {name:'Empirisme britannique',mix:{sens:60,langage:20,nature:20},desc:'ExpÃ©rience avant tout'},
      {name:'IdÃ©alisme allemand',mix:{raison:40,foi:30,liberte:30},desc:'SynthÃ¨se de lâ€™esprit'},
      {name:'Marxisme',mix:{travail:40,pouvoir:30,temps:30},desc:'Histoire et lutte sociale'},
      {name:'Psychanalyse freudienne',mix:{inconscient:50,temps:20,langage:30},desc:'Forces cachÃ©es rÃ©vÃ©lÃ©es'}
    ];

    const state = { pours:[], volume:0, shaken:false };

    const bottlesEl=document.getElementById('bottles');
    const recipesEl=document.getElementById('recipes');
    const historyEl=document.getElementById('history');
    const liquidEl=document.getElementById('liquid');
    const volumeEl=document.getElementById('volume');
    const stateEl=document.getElementById('state');
    const reactionEl=document.getElementById('reaction');
    const garnishEl=document.getElementById('garnish');

    INGREDIENTS.forEach(ing=>{
      const div=document.createElement('div');
      div.className='bottle'; div.dataset.id=ing.id;
      div.innerHTML=`<div class="cap" style="background:${ing.color}">${ing.abbr}</div>
        <div class="meta"><strong>${ing.name}</strong><small>Force ${ing.strength} â€¢ Valeur ${ing.flavor}</small></div>
        <div><small>+10</small></div>`;
      div.addEventListener('click',()=>pour(ing.id,10));
      bottlesEl.appendChild(div);
    });

    RECIPES.forEach(r=>{
      const d=document.createElement('div'); d.className='recipe';
      const list=Object.entries(r.mix).map(([k,v])=>`${k}:${v}`).join(', ');
      d.innerHTML=`<strong>${r.name}</strong><div style="font-size:13px;color:var(--muted)">${r.desc}</div><div style="margin-top:6px;font-size:12px">${list}</div>`;
      recipesEl.appendChild(d);
    });

    document.getElementById('undo').addEventListener('click',undo);
    document.getElementById('clear').addEventListener('click',clearGlass);
    document.getElementById('shake').addEventListener('click',()=>{state.shaken=true;stateEl.textContent='DialectisÃ©';showReaction('DialectisÃ© !');});
    document.getElementById('serve').addEventListener('click',serve);

    function pour(id,amount){
      if(state.volume+amount>100){showReaction('Concept saturÃ© !');return;}
      state.pours.push({id,amount}); state.volume+=amount;
      updateGlass(); showReaction(`AjoutÃ© ${amount} de ${id}`);
    }
    function undo(){const last=state.pours.pop();if(!last){showReaction('Rien Ã  annuler');return;}
      state.volume-=last.amount;updateGlass();showReaction(`RetirÃ© ${last.id}`);}
    function clearGlass(){state.pours=[];state.volume=0;state.shaken=false;updateGlass();showReaction('Concept effacÃ©');}
    function serve(){
      if(state.volume===0){showReaction('Vide !');return;}
      const s=summarizeState(); const score=evaluate(s.composition);
      appendHistory(`${new Date().toLocaleTimeString()} â€” ${score.text} â€” ${s.summary}`);
      animateOutcome(score); state.pours=[];state.volume=0;state.shaken=false;setTimeout(updateGlass,800);
    }

    function summarizeState(){
      const map={}; state.pours.forEach(p=>map[p.id]=(map[p.id]||0)+p.amount);
      const comp={}; Object.keys(map).forEach(k=>comp[k]=Math.round(map[k]/(state.volume||1)*100));
      const parts=Object.entries(map).map(([k,v])=>`${k}:${v}`).join(', ');
      return {map,composition:comp,summary:parts||'vide'};
    }

    function evaluate(composition){
      let best={score:Infinity,recipe:null};
      RECIPES.forEach(r=>{
        const keys=new Set([...Object.keys(r.mix),...Object.keys(composition)]);
        let dist=0; keys.forEach(k=>{const want=r.mix[k]||0;const have=composition[k]||0;dist+=(have-want)**2;});
        if(dist<best.score){best.score=dist;best.recipe=r;}
      });
      const normalized=Math.max(0,100-Math.sqrt(best.score));
      let text='Inclassable';
      if(normalized>80) text=`Excellent â€” proche de Â«${best.recipe.name}Â»`;
      else if(normalized>60) text=`TrÃ¨s bon â€” rappelle Â«${best.recipe.name}Â»`;
      else if(normalized>35) text=`Correct â€” expÃ©rimental`;
      else if(normalized>15) text=`Confus â€” mÃ©lange incertain`;
      else text=`DÃ©sastreux â€” aporie totale !`;
      return {score:normalized,text,recipe:best.recipe};
    }

    function animateOutcome(score){
      reactionEl.textContent=score.text; reactionEl.classList.add('show');
      garnishEl.textContent=score.score>70?'ðŸ“˜':'ðŸ“œ';
      setTimeout(()=>reactionEl.classList.remove('show'),1600);
    }

    function appendHistory(text){
      const d=document.createElement('div'); d.style.padding='6px 4px'; d.style.fontSize='13px';
      d.textContent=text; historyEl.prepend(d);
    }
    function updateGlass(){liquidEl.style.height=Math.min(100,state.volume)+'%';volumeEl.textContent=state.volume;}
    function showReaction(txt){reactionEl.textContent=txt;reactionEl.classList.add('show');setTimeout(()=>reactionEl.classList.remove('show'),900);}
    updateGlass(); appendHistory('Bienvenue â€” composez votre doctrine !');
  </script>
</body>
</html>
